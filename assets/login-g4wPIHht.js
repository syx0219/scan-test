import{u as U,t as Y,n as $,m as O,e as me,c as J,a as ze,r as De,i as I,I as N,w as Q,b as Fe,d as be,F as ve,p as H,g as Oe,f as Ne,s as qe,h as We,j as je,k as Ze,l as se,o as Ge,q as ce,v as Ue,x as He,y as Ke,z as Ye,C as Je,A as Qe,B as Xe,_ as pe,D as et,E as tt,G as ee}from"./main-BFxP1EBP.js";import{g as he,d as X,f as c,b as nt,r as K,c as R,w as at,n as j,m as lt,H as ye,v as ae,p as it,F as rt,e as ot,o as st,D as Z,E as ue,u as G,G as te}from"./vue-DxL3IdxJ.js";let ct=0;function ut(){const e=he(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++ct}`}const[dt,z]=J("cell"),_e={tag:O("div"),icon:String,size:String,title:$,value:$,label:$,center:Boolean,isLink:Boolean,border:Y,iconPrefix:String,valueClass:U,labelClass:U,titleClass:U,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},ft=me({},_e,De);var gt=X({name:dt,props:ft,setup(e,{slots:n}){const r=ze(),l=()=>{if(n.label||I(e.label))return c("div",{class:[z("label"),e.labelClass]},[n.label?n.label():e.label])},o=()=>{var u;if(n.title||I(e.title)){const m=(u=n.title)==null?void 0:u.call(n);return Array.isArray(m)&&m.length===0?void 0:c("div",{class:[z("title"),e.titleClass],style:e.titleStyle},[m||c("span",null,[e.title]),l()])}},f=()=>{const u=n.value||n.default;if(u||I(e.value))return c("div",{class:[z("value"),e.valueClass]},[u?u():c("span",null,[e.value])])},B=()=>{if(n.icon)return n.icon();if(e.icon)return c(N,{name:e.icon,class:z("left-icon"),classPrefix:e.iconPrefix},null)},k=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const u=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return c(N,{name:u,class:z("right-icon")},null)}};return()=>{var u;const{tag:m,size:g,center:P,border:C,isLink:T,required:A}=e,_=(u=e.clickable)!=null?u:T,a={center:P,required:!!A,clickable:_,borderless:!C};return g&&(a[g]=!!g),c(m,{class:z(a),role:_?"button":void 0,tabindex:_?0:void 0,onClick:r},{default:()=>{var d;return[B(),o(),f(),k(),(d=n.extra)==null?void 0:d.call(n)]}})}}});const mt=Q(gt),[bt,vt]=J("form"),ht={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:$,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:Y,showErrorMessage:Y,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var yt=X({name:bt,props:ht,emits:["submit","failed"],setup(e,{emit:n,slots:r}){const{children:l,linkChildren:o}=Fe(ve),f=a=>a?l.filter(d=>a.includes(d.name)):l,B=a=>new Promise((d,v)=>{const w=[];f(a).reduce((p,D)=>p.then(()=>{if(!w.length)return D.validate().then(F=>{F&&w.push(F)})}),Promise.resolve()).then(()=>{w.length?v(w):d()})}),k=a=>new Promise((d,v)=>{const w=f(a);Promise.all(w.map(y=>y.validate())).then(y=>{y=y.filter(Boolean),y.length?v(y):d()})}),u=a=>{const d=l.find(v=>v.name===a);return d?new Promise((v,w)=>{d.validate().then(y=>{y?w(y):v()})}):Promise.reject()},m=a=>typeof a=="string"?u(a):e.validateFirst?B(a):k(a),g=a=>{typeof a=="string"&&(a=[a]),f(a).forEach(v=>{v.resetValidation()})},P=()=>l.reduce((a,d)=>(a[d.name]=d.getValidationStatus(),a),{}),C=(a,d)=>{l.some(v=>v.name===a?(v.$el.scrollIntoView(d),!0):!1)},T=()=>l.reduce((a,d)=>(d.name!==void 0&&(a[d.name]=d.formValue.value),a),{}),A=()=>{const a=T();m().then(()=>n("submit",a)).catch(d=>{n("failed",{values:a,errors:d});const{scrollToError:v,scrollToErrorPosition:w}=e;v&&d[0].name&&C(d[0].name,w?{block:w}:void 0)})},_=a=>{H(a),A()};return o({props:e}),be({submit:A,validate:m,getValues:T,scrollToField:C,resetValidation:g,getValidationStatus:P}),()=>{var a;return c("form",{class:vt(),onSubmit:_},[(a=r.default)==null?void 0:a.call(r)])}}});const _t=Q(yt);function we(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function wt(e,n){if(we(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function St(e,n){return new Promise(r=>{const l=n.validator(e,n);if(je(l)){l.then(r);return}r(l)})}function de(e,n){const{message:r}=n;return We(r)?r(e,n):r||""}function Vt({target:e}){e.composing=!0}function fe({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function xt(e,n){const r=Oe();e.style.height="auto";let l=e.scrollHeight;if(Ne(n)){const{maxHeight:o,minHeight:f}=n;o!==void 0&&(l=Math.min(l,o)),f!==void 0&&(l=Math.max(l,f))}l&&(e.style.height=`${l}px`,qe(r))}function kt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function E(e){return[...e].length}function ne(e,n){return[...e].slice(0,n).join("")}const[Ct,S]=J("field"),Et={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:$,max:Number,min:Number,formatter:Function,clearIcon:O("clear"),modelValue:Ke(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:O("focus"),formatTrigger:O("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},It=me({},_e,Et,{rows:$,type:O("text"),rules:Array,autosize:[Boolean,Object],labelWidth:$,labelClass:U,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Bt=X({name:Ct,props:It,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:r}){const l=ut(),o=nt({status:"unvalidated",focused:!1,validateMessage:""}),f=K(),B=K(),k=K(),{parent:u}=Ze(ve),m=()=>{var t;return String((t=e.modelValue)!=null?t:"")},g=t=>{if(I(e[t]))return e[t];if(u&&I(u.props[t]))return u.props[t]},P=R(()=>{const t=g("readonly");if(e.clearable&&!t){const i=m()!=="",s=e.clearTrigger==="always"||e.clearTrigger==="focus"&&o.focused;return i&&s}return!1}),C=R(()=>k.value&&r.input?k.value():e.modelValue),T=R(()=>{var t;const i=g("required");return i==="auto"?(t=e.rules)==null?void 0:t.some(s=>s.required):i}),A=t=>t.reduce((i,s)=>i.then(()=>{if(o.status==="failed")return;let{value:b}=C;if(s.formatter&&(b=s.formatter(b,s)),!wt(b,s)){o.status="failed",o.validateMessage=de(b,s);return}if(s.validator)return we(b)&&s.validateEmpty===!1?void 0:St(b,s).then(h=>{h&&typeof h=="string"?(o.status="failed",o.validateMessage=h):h===!1&&(o.status="failed",o.validateMessage=de(b,s))})}),Promise.resolve()),_=()=>{o.status="unvalidated",o.validateMessage=""},a=()=>n("endValidate",{status:o.status,message:o.validateMessage}),d=(t=e.rules)=>new Promise(i=>{_(),t?(n("startValidate"),A(t).then(()=>{o.status==="failed"?(i({name:e.name,message:o.validateMessage}),a()):(o.status="passed",i(),a())})):i()}),v=t=>{if(u&&e.rules){const{validateTrigger:i}=u.props,s=ce(i).includes(t),b=e.rules.filter(h=>h.trigger?ce(h.trigger).includes(t):s);b.length&&d(b)}},w=t=>{var i;const{maxlength:s}=e;if(I(s)&&E(t)>+s){const b=m();if(b&&E(b)===+s)return b;const h=(i=f.value)==null?void 0:i.selectionEnd;if(o.focused&&h){const L=[...t],M=L.length-+s;return L.splice(h-M,M),L.join("")}return ne(t,+s)}return t},y=(t,i="onChange")=>{var s,b;const h=t;t=w(t);const L=E(h)-E(t);if(e.type==="number"||e.type==="digit"){const x=e.type==="number";if(t=Ue(t,x,x),i==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const V=He(+t,(s=e.min)!=null?s:-1/0,(b=e.max)!=null?b:1/0);+t!==V&&(t=V.toString())}}let M=0;if(e.formatter&&i===e.formatTrigger){const{formatter:x,maxlength:V}=e;if(t=x(t),I(V)&&E(t)>+V&&(t=ne(t,+V)),f.value&&o.focused){const{selectionEnd:W}=f.value,oe=ne(h,W);M=E(x(oe))-E(oe)}}if(f.value&&f.value.value!==t)if(o.focused){let{selectionStart:x,selectionEnd:V}=f.value;if(f.value.value=t,I(x)&&I(V)){const W=E(t);L?(x-=L,V-=L):M&&(x+=M,V+=M),f.value.setSelectionRange(Math.min(x,W),Math.min(V,W))}}else f.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},p=t=>{t.target.composing||y(t.target.value)},D=()=>{var t;return(t=f.value)==null?void 0:t.blur()},F=()=>{var t;return(t=f.value)==null?void 0:t.focus()},q=()=>{const t=f.value;e.type==="textarea"&&e.autosize&&t&&xt(t,e.autosize)},Se=t=>{o.focused=!0,n("focus",t),j(q),g("readonly")&&D()},Ve=t=>{o.focused=!1,y(m(),"onBlur"),n("blur",t),!g("readonly")&&(v("onBlur"),j(q),Ye())},le=t=>n("clickInput",t),xe=t=>n("clickLeftIcon",t),ke=t=>n("clickRightIcon",t),Ce=t=>{H(t),n("update:modelValue",""),n("clear",t)},ie=R(()=>{if(typeof e.error=="boolean")return e.error;if(u&&u.props.showError&&o.status==="failed")return!0}),Ee=R(()=>{const t=g("labelWidth"),i=g("labelAlign");if(t&&i!=="top")return{width:se(t)}}),Ie=t=>{t.keyCode===13&&(!(u&&u.props.submitOnEnter)&&e.type!=="textarea"&&H(t),e.type==="search"&&D()),n("keypress",t)},re=()=>e.id||`${l}-input`,Be=()=>o.status,Pe=()=>{const t=S("control",[g("inputAlign"),{error:ie.value,custom:!!r.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(r.input)return c("div",{class:t,onClick:le},[r.input()]);const i={id:re(),ref:f,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:g("disabled"),readonly:g("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${l}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:Ve,onFocus:Se,onInput:p,onClick:le,onChange:fe,onKeypress:Ie,onCompositionend:fe,onCompositionstart:Vt};return e.type==="textarea"?c("textarea",ae(i,{inputmode:e.inputmode}),null):c("input",ae(kt(e.type,e.inputmode),i),null)},Te=()=>{const t=r["left-icon"];if(e.leftIcon||t)return c("div",{class:S("left-icon"),onClick:xe},[t?t():c(N,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ae=()=>{const t=r["right-icon"];if(e.rightIcon||t)return c("div",{class:S("right-icon"),onClick:ke},[t?t():c(N,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Le=()=>{if(e.showWordLimit&&e.maxlength){const t=E(m());return c("div",{class:S("word-limit")},[c("span",{class:S("word-num")},[t]),ye("/"),e.maxlength])}},Me=()=>{if(u&&u.props.showErrorMessage===!1)return;const t=e.errorMessage||o.validateMessage;if(t){const i=r["error-message"],s=g("errorMessageAlign");return c("div",{class:S("error-message",s)},[i?i({message:t}):t])}},$e=()=>{const t=g("labelWidth"),i=g("labelAlign"),s=g("colon")?":":"";if(r.label)return[r.label(),s];if(e.label)return c("label",{id:`${l}-label`,for:r.input?void 0:re(),"data-allow-mismatch":"attribute",onClick:b=>{H(b),F()},style:i==="top"&&t?{width:se(t)}:void 0},[e.label+s])},Re=()=>[c("div",{class:S("body")},[Pe(),P.value&&c(N,{ref:B,name:e.clearIcon,class:S("clear")},null),Ae(),r.button&&c("div",{class:S("button")},[r.button()])]),Le(),Me()];return be({blur:D,focus:F,validate:d,formValue:C,resetValidation:_,getValidationStatus:Be}),it(Je,{customValue:k,resetValidation:_,validateWithTrigger:v}),at(()=>e.modelValue,()=>{y(m()),_(),v("onChange"),j(q)}),lt(()=>{y(m(),e.formatTrigger),j(q)}),Ge("touchstart",Ce,{target:R(()=>{var t;return(t=B.value)==null?void 0:t.$el})}),()=>{const t=g("disabled"),i=g("labelAlign"),s=Te(),b=()=>{const h=$e();return i==="top"?[s,h].filter(Boolean):h||[]};return c(mt,{size:e.size,class:S({error:ie.value,disabled:t,[`label-${i}`]:i}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ee.value,valueClass:S("value"),titleClass:[S("label",[i,{required:T.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:s&&i!=="top"?()=>s:null,title:b,value:Re,extra:r.extra})}}});const Pt=Q(Bt),[Tt,ge]=J("cell-group"),At={title:String,inset:Boolean,border:Y};var Lt=X({name:Tt,inheritAttrs:!1,props:At,setup(e,{slots:n,attrs:r}){const l=()=>{var f;return c("div",ae({class:[ge({inset:e.inset}),{[Xe]:e.border&&!e.inset}]},r,Qe()),[(f=n.default)==null?void 0:f.call(n)])},o=()=>c("div",{class:ge("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?c(rt,null,[o(),l()]):l()}});const Mt=Q(Lt),$t={class:"login"},Rt={class:"warp"},zt={class:"title"},Dt={style:{margin:"16px"}},Ft={__name:"login",setup(e){const n=et(),{$t:r}=he().proxy,l=K({email:"",password:""}),o=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,f=/^((?=.*[A-Za-z])(?=.*\d)|(?=.*[A-Za-z])(?=.*[!@#$%^&*()_+\-\=])|(?=.*\d)(?=.*[!@#$%^&*()_+\-\=]))[A-Za-z\d!@#$%^&*()_+\-\=]{8,}$/,B=m=>{if(!o.test(m))return"邮箱格式错误"},k=m=>{if(m===""||!f.test(m))return"密码格式错误"},u=async()=>{if(alert("submit",l.value),l.value.password==="")return ee("password cannot be empty");if(l.value.email==="")return ee("Email cannot be empty");try{n.toLogin(l.value)}catch(m){m.indexOf("Email already exists")!=-1&&(l.value.password=""),ee(m),console.error(m)}};return(m,g)=>{const P=Pt,C=Mt,T=tt,A=_t;return st(),ot("div",$t,[Z("div",Rt,[Z("p",zt,ue(G(r)("login.loginLabel")),1),Z("div",null,[c(A,{"label-align":"top"},{default:te(()=>[c(C,{inset:""},{default:te(()=>[c(P,{modelValue:l.value.email,"onUpdate:modelValue":g[0]||(g[0]=_=>l.value.email=_),label:G(r)("login.emailLabel"),name:"email",rules:[{validator:B}]},null,8,["modelValue","label","rules"]),c(P,{modelValue:l.value.password,"onUpdate:modelValue":g[1]||(g[1]=_=>l.value.password=_),type:"password",name:"password",label:G(r)("login.passwordLabel"),rules:[{validator:k}]},null,8,["modelValue","label","rules"])]),_:1}),Z("div",Dt,[c(T,{round:"",block:"",type:"primary",onClick:u},{default:te(()=>[ye(ue(G(r)("login.submitBut")),1)]),_:1})])]),_:1})])])])}}},qt=pe(Ft,[["__scopeId","data-v-6ee3a2cd"]]);export{qt as default};
