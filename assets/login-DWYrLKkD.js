import{u as U,t as Y,n as $,m as O,e as me,c as J,a as ze,r as De,i as I,I as N,w as Q,b as Fe,d as be,F as he,p as H,g as Oe,f as Ne,s as qe,h as We,j as je,k as Ze,l as oe,o as Ge,q as se,v as Ue,x as He,y as Ke,z as Ye,C as Je,A as Qe,B as Xe,_ as pe,D as et,E as tt,G as ce}from"./main-DdBQeVJB.js";import{g as ve,d as X,f as c,b as nt,r as K,c as R,w as at,n as j,m as lt,H as ye,v as ne,p as it,F as rt,e as ot,o as st,D as Z,E as ue,u as G,G as ee}from"./vue-DxL3IdxJ.js";let ct=0;function ut(){const e=ve(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++ct}`}const[dt,z]=J("cell"),_e={tag:O("div"),icon:String,size:String,title:$,value:$,label:$,center:Boolean,isLink:Boolean,border:Y,iconPrefix:String,valueClass:U,labelClass:U,titleClass:U,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},ft=me({},_e,De);var gt=X({name:dt,props:ft,setup(e,{slots:n}){const i=ze(),s=()=>{if(n.label||I(e.label))return c("div",{class:[z("label"),e.labelClass]},[n.label?n.label():e.label])},r=()=>{var d;if(n.title||I(e.title)){const m=(d=n.title)==null?void 0:d.call(n);return Array.isArray(m)&&m.length===0?void 0:c("div",{class:[z("title"),e.titleClass],style:e.titleStyle},[m||c("span",null,[e.title]),s()])}},g=()=>{const d=n.value||n.default;if(d||I(e.value))return c("div",{class:[z("value"),e.valueClass]},[d?d():c("span",null,[e.value])])},B=()=>{if(n.icon)return n.icon();if(e.icon)return c(N,{name:e.icon,class:z("left-icon"),classPrefix:e.iconPrefix},null)},k=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const d=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return c(N,{name:d,class:z("right-icon")},null)}};return()=>{var d;const{tag:m,size:u,center:P,border:C,isLink:T,required:A}=e,_=(d=e.clickable)!=null?d:T,a={center:P,required:!!A,clickable:_,borderless:!C};return u&&(a[u]=!!u),c(m,{class:z(a),role:_?"button":void 0,tabindex:_?0:void 0,onClick:i},{default:()=>{var f;return[B(),r(),g(),k(),(f=n.extra)==null?void 0:f.call(n)]}})}}});const mt=Q(gt),[bt,ht]=J("form"),vt={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:$,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:Y,showErrorMessage:Y,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var yt=X({name:bt,props:vt,emits:["submit","failed"],setup(e,{emit:n,slots:i}){const{children:s,linkChildren:r}=Fe(he),g=a=>a?s.filter(f=>a.includes(f.name)):s,B=a=>new Promise((f,h)=>{const S=[];g(a).reduce((p,D)=>p.then(()=>{if(!S.length)return D.validate().then(F=>{F&&S.push(F)})}),Promise.resolve()).then(()=>{S.length?h(S):f()})}),k=a=>new Promise((f,h)=>{const S=g(a);Promise.all(S.map(y=>y.validate())).then(y=>{y=y.filter(Boolean),y.length?h(y):f()})}),d=a=>{const f=s.find(h=>h.name===a);return f?new Promise((h,S)=>{f.validate().then(y=>{y?S(y):h()})}):Promise.reject()},m=a=>typeof a=="string"?d(a):e.validateFirst?B(a):k(a),u=a=>{typeof a=="string"&&(a=[a]),g(a).forEach(h=>{h.resetValidation()})},P=()=>s.reduce((a,f)=>(a[f.name]=f.getValidationStatus(),a),{}),C=(a,f)=>{s.some(h=>h.name===a?(h.$el.scrollIntoView(f),!0):!1)},T=()=>s.reduce((a,f)=>(f.name!==void 0&&(a[f.name]=f.formValue.value),a),{}),A=()=>{const a=T();m().then(()=>n("submit",a)).catch(f=>{n("failed",{values:a,errors:f});const{scrollToError:h,scrollToErrorPosition:S}=e;h&&f[0].name&&C(f[0].name,S?{block:S}:void 0)})},_=a=>{H(a),A()};return r({props:e}),be({submit:A,validate:m,getValues:T,scrollToField:C,resetValidation:u,getValidationStatus:P}),()=>{var a;return c("form",{class:ht(),onSubmit:_},[(a=i.default)==null?void 0:a.call(i)])}}});const _t=Q(yt);function Se(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function St(e,n){if(Se(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function wt(e,n){return new Promise(i=>{const s=n.validator(e,n);if(je(s)){s.then(i);return}i(s)})}function de(e,n){const{message:i}=n;return We(i)?i(e,n):i||""}function Vt({target:e}){e.composing=!0}function fe({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function xt(e,n){const i=Oe();e.style.height="auto";let s=e.scrollHeight;if(Ne(n)){const{maxHeight:r,minHeight:g}=n;r!==void 0&&(s=Math.min(s,r)),g!==void 0&&(s=Math.max(s,g))}s&&(e.style.height=`${s}px`,qe(i))}function kt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function E(e){return[...e].length}function te(e,n){return[...e].slice(0,n).join("")}const[Ct,w]=J("field"),Et={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:$,max:Number,min:Number,formatter:Function,clearIcon:O("clear"),modelValue:Ke(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:O("focus"),formatTrigger:O("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},It=me({},_e,Et,{rows:$,type:O("text"),rules:Array,autosize:[Boolean,Object],labelWidth:$,labelClass:U,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Bt=X({name:Ct,props:It,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:i}){const s=ut(),r=nt({status:"unvalidated",focused:!1,validateMessage:""}),g=K(),B=K(),k=K(),{parent:d}=Ze(he),m=()=>{var t;return String((t=e.modelValue)!=null?t:"")},u=t=>{if(I(e[t]))return e[t];if(d&&I(d.props[t]))return d.props[t]},P=R(()=>{const t=u("readonly");if(e.clearable&&!t){const l=m()!=="",o=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return l&&o}return!1}),C=R(()=>k.value&&i.input?k.value():e.modelValue),T=R(()=>{var t;const l=u("required");return l==="auto"?(t=e.rules)==null?void 0:t.some(o=>o.required):l}),A=t=>t.reduce((l,o)=>l.then(()=>{if(r.status==="failed")return;let{value:b}=C;if(o.formatter&&(b=o.formatter(b,o)),!St(b,o)){r.status="failed",r.validateMessage=de(b,o);return}if(o.validator)return Se(b)&&o.validateEmpty===!1?void 0:wt(b,o).then(v=>{v&&typeof v=="string"?(r.status="failed",r.validateMessage=v):v===!1&&(r.status="failed",r.validateMessage=de(b,o))})}),Promise.resolve()),_=()=>{r.status="unvalidated",r.validateMessage=""},a=()=>n("endValidate",{status:r.status,message:r.validateMessage}),f=(t=e.rules)=>new Promise(l=>{_(),t?(n("startValidate"),A(t).then(()=>{r.status==="failed"?(l({name:e.name,message:r.validateMessage}),a()):(r.status="passed",l(),a())})):l()}),h=t=>{if(d&&e.rules){const{validateTrigger:l}=d.props,o=se(l).includes(t),b=e.rules.filter(v=>v.trigger?se(v.trigger).includes(t):o);b.length&&f(b)}},S=t=>{var l;const{maxlength:o}=e;if(I(o)&&E(t)>+o){const b=m();if(b&&E(b)===+o)return b;const v=(l=g.value)==null?void 0:l.selectionEnd;if(r.focused&&v){const L=[...t],M=L.length-+o;return L.splice(v-M,M),L.join("")}return te(t,+o)}return t},y=(t,l="onChange")=>{var o,b;const v=t;t=S(t);const L=E(v)-E(t);if(e.type==="number"||e.type==="digit"){const x=e.type==="number";if(t=Ue(t,x,x),l==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const V=He(+t,(o=e.min)!=null?o:-1/0,(b=e.max)!=null?b:1/0);+t!==V&&(t=V.toString())}}let M=0;if(e.formatter&&l===e.formatTrigger){const{formatter:x,maxlength:V}=e;if(t=x(t),I(V)&&E(t)>+V&&(t=te(t,+V)),g.value&&r.focused){const{selectionEnd:W}=g.value,re=te(v,W);M=E(x(re))-E(re)}}if(g.value&&g.value.value!==t)if(r.focused){let{selectionStart:x,selectionEnd:V}=g.value;if(g.value.value=t,I(x)&&I(V)){const W=E(t);L?(x-=L,V-=L):M&&(x+=M,V+=M),g.value.setSelectionRange(Math.min(x,W),Math.min(V,W))}}else g.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},p=t=>{t.target.composing||y(t.target.value)},D=()=>{var t;return(t=g.value)==null?void 0:t.blur()},F=()=>{var t;return(t=g.value)==null?void 0:t.focus()},q=()=>{const t=g.value;e.type==="textarea"&&e.autosize&&t&&xt(t,e.autosize)},we=t=>{r.focused=!0,n("focus",t),j(q),u("readonly")&&D()},Ve=t=>{r.focused=!1,y(m(),"onBlur"),n("blur",t),!u("readonly")&&(h("onBlur"),j(q),Ye())},ae=t=>n("clickInput",t),xe=t=>n("clickLeftIcon",t),ke=t=>n("clickRightIcon",t),Ce=t=>{H(t),n("update:modelValue",""),n("clear",t)},le=R(()=>{if(typeof e.error=="boolean")return e.error;if(d&&d.props.showError&&r.status==="failed")return!0}),Ee=R(()=>{const t=u("labelWidth"),l=u("labelAlign");if(t&&l!=="top")return{width:oe(t)}}),Ie=t=>{t.keyCode===13&&(!(d&&d.props.submitOnEnter)&&e.type!=="textarea"&&H(t),e.type==="search"&&D()),n("keypress",t)},ie=()=>e.id||`${s}-input`,Be=()=>r.status,Pe=()=>{const t=w("control",[u("inputAlign"),{error:le.value,custom:!!i.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(i.input)return c("div",{class:t,onClick:ae},[i.input()]);const l={id:ie(),ref:g,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${s}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:Ve,onFocus:we,onInput:p,onClick:ae,onChange:fe,onKeypress:Ie,onCompositionend:fe,onCompositionstart:Vt};return e.type==="textarea"?c("textarea",ne(l,{inputmode:e.inputmode}),null):c("input",ne(kt(e.type,e.inputmode),l),null)},Te=()=>{const t=i["left-icon"];if(e.leftIcon||t)return c("div",{class:w("left-icon"),onClick:xe},[t?t():c(N,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ae=()=>{const t=i["right-icon"];if(e.rightIcon||t)return c("div",{class:w("right-icon"),onClick:ke},[t?t():c(N,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Le=()=>{if(e.showWordLimit&&e.maxlength){const t=E(m());return c("div",{class:w("word-limit")},[c("span",{class:w("word-num")},[t]),ye("/"),e.maxlength])}},Me=()=>{if(d&&d.props.showErrorMessage===!1)return;const t=e.errorMessage||r.validateMessage;if(t){const l=i["error-message"],o=u("errorMessageAlign");return c("div",{class:w("error-message",o)},[l?l({message:t}):t])}},$e=()=>{const t=u("labelWidth"),l=u("labelAlign"),o=u("colon")?":":"";if(i.label)return[i.label(),o];if(e.label)return c("label",{id:`${s}-label`,for:i.input?void 0:ie(),"data-allow-mismatch":"attribute",onClick:b=>{H(b),F()},style:l==="top"&&t?{width:oe(t)}:void 0},[e.label+o])},Re=()=>[c("div",{class:w("body")},[Pe(),P.value&&c(N,{ref:B,name:e.clearIcon,class:w("clear")},null),Ae(),i.button&&c("div",{class:w("button")},[i.button()])]),Le(),Me()];return be({blur:D,focus:F,validate:f,formValue:C,resetValidation:_,getValidationStatus:Be}),it(Je,{customValue:k,resetValidation:_,validateWithTrigger:h}),at(()=>e.modelValue,()=>{y(m()),_(),h("onChange"),j(q)}),lt(()=>{y(m(),e.formatTrigger),j(q)}),Ge("touchstart",Ce,{target:R(()=>{var t;return(t=B.value)==null?void 0:t.$el})}),()=>{const t=u("disabled"),l=u("labelAlign"),o=Te(),b=()=>{const v=$e();return l==="top"?[o,v].filter(Boolean):v||[]};return c(mt,{size:e.size,class:w({error:le.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ee.value,valueClass:w("value"),titleClass:[w("label",[l,{required:T.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:o&&l!=="top"?()=>o:null,title:b,value:Re,extra:i.extra})}}});const Pt=Q(Bt),[Tt,ge]=J("cell-group"),At={title:String,inset:Boolean,border:Y};var Lt=X({name:Tt,inheritAttrs:!1,props:At,setup(e,{slots:n,attrs:i}){const s=()=>{var g;return c("div",ne({class:[ge({inset:e.inset}),{[Xe]:e.border&&!e.inset}]},i,Qe()),[(g=n.default)==null?void 0:g.call(n)])},r=()=>c("div",{class:ge("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?c(rt,null,[r(),s()]):s()}});const Mt=Q(Lt),$t={class:"login"},Rt={class:"warp"},zt={class:"title"},Dt={style:{margin:"16px"}},Ft={__name:"login",setup(e){const n=et(),{$t:i}=ve().proxy,s=K({email:"",password:""}),r=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,g=/^((?=.*[A-Za-z])(?=.*\d)|(?=.*[A-Za-z])(?=.*[!@#$%^&*()_+\-\=])|(?=.*\d)(?=.*[!@#$%^&*()_+\-\=]))[A-Za-z\d!@#$%^&*()_+\-\=]{8,}$/,B=m=>{if(!r.test(m))return"邮箱格式错误"},k=m=>{if(m===""||!g.test(m))return"密码格式错误"},d=async m=>{if(m.password==="")return ce("password cannot be empty");if(m.email==="")return ce("Email cannot be empty");try{n.toLogin(m)}catch(u){u.indexOf("Email already exists")!=-1&&(s.value.password="",activeName.value="login"),console.error(u)}};return(m,u)=>{const P=Pt,C=Mt,T=tt,A=_t;return st(),ot("div",$t,[Z("div",Rt,[Z("p",zt,ue(G(i)("login.loginLabel")),1),Z("div",null,[c(A,{onSubmit:d,"label-align":"top"},{default:ee(()=>[c(C,{inset:""},{default:ee(()=>[c(P,{modelValue:s.value.email,"onUpdate:modelValue":u[0]||(u[0]=_=>s.value.email=_),label:G(i)("login.emailLabel"),name:"email",rules:[{validator:B}]},null,8,["modelValue","label","rules"]),c(P,{modelValue:s.value.password,"onUpdate:modelValue":u[1]||(u[1]=_=>s.value.password=_),type:"password",name:"password",label:G(i)("login.passwordLabel"),rules:[{validator:k}]},null,8,["modelValue","label","rules"])]),_:1}),Z("div",Dt,[c(T,{round:"",block:"",type:"primary","native-type":"submit"},{default:ee(()=>[ye(ue(G(i)("login.submitBut")),1)]),_:1})])]),_:1})])])])}}},qt=pe(Ft,[["__scopeId","data-v-e2a42f51"]]);export{qt as default};
