import{u as K,t as J,n as $,m as N,e as me,c as X,a as ze,r as Fe,i as B,I as q,w as Q,b as De,d as be,F as ve,p as Y,g as Oe,f as Ne,s as qe,h as je,j as We,k as Ze,l as se,o as Ge,q as ce,v as Ue,x as He,y as Ke,z as Ye,C as Je,A as Xe,B as Qe,_ as pe,D as et,E as tt,G as te}from"./main-Dept7Fgo.js";import{g as he,d as p,f as s,b as nt,r as j,c as R,w as at,n as G,m as lt,H as ye,v as ae,p as it,F as rt,e as ot,o as st,D as z,E as ue,u as U,G as H,X as ct}from"./vue-DNnLlXmC.js";let ut=0;function dt(){const e=he(),{name:n="unknown"}=(e==null?void 0:e.type)||{};return`${n}-${++ut}`}const[ft,F]=X("cell"),we={tag:N("div"),icon:String,size:String,title:$,value:$,label:$,center:Boolean,isLink:Boolean,border:J,iconPrefix:String,valueClass:K,labelClass:K,titleClass:K,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},gt=me({},we,Fe);var mt=p({name:ft,props:gt,setup(e,{slots:n}){const i=ze(),c=()=>{if(n.label||B(e.label))return s("div",{class:[F("label"),e.labelClass]},[n.label?n.label():e.label])},l=()=>{var d;if(n.title||B(e.title)){const b=(d=n.title)==null?void 0:d.call(n);return Array.isArray(b)&&b.length===0?void 0:s("div",{class:[F("title"),e.titleClass],style:e.titleStyle},[b||s("span",null,[e.title]),c()])}},g=()=>{const d=n.value||n.default;if(d||B(e.value))return s("div",{class:[F("value"),e.valueClass]},[d?d():s("span",null,[e.value])])},P=()=>{if(n.icon)return n.icon();if(e.icon)return s(q,{name:e.icon,class:F("left-icon"),classPrefix:e.iconPrefix},null)},E=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const d=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return s(q,{name:d,class:F("right-icon")},null)}};return()=>{var d;const{tag:b,size:u,center:h,border:k,isLink:T,required:A}=e,_=(d=e.clickable)!=null?d:T,a={center:h,required:!!A,clickable:_,borderless:!k};return u&&(a[u]=!!u),s(b,{class:F(a),role:_?"button":void 0,tabindex:_?0:void 0,onClick:i},{default:()=>{var f;return[P(),l(),g(),E(),(f=n.extra)==null?void 0:f.call(n)]}})}}});const bt=Q(mt),[vt,ht]=X("form"),yt={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:$,labelAlign:String,inputAlign:String,scrollToError:Boolean,scrollToErrorPosition:String,validateFirst:Boolean,submitOnEnter:J,showErrorMessage:J,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var wt=p({name:vt,props:yt,emits:["submit","failed"],setup(e,{emit:n,slots:i}){const{children:c,linkChildren:l}=De(ve),g=a=>a?c.filter(f=>a.includes(f.name)):c,P=a=>new Promise((f,v)=>{const S=[];g(a).reduce((ee,D)=>ee.then(()=>{if(!S.length)return D.validate().then(O=>{O&&S.push(O)})}),Promise.resolve()).then(()=>{S.length?v(S):f()})}),E=a=>new Promise((f,v)=>{const S=g(a);Promise.all(S.map(w=>w.validate())).then(w=>{w=w.filter(Boolean),w.length?v(w):f()})}),d=a=>{const f=c.find(v=>v.name===a);return f?new Promise((v,S)=>{f.validate().then(w=>{w?S(w):v()})}):Promise.reject()},b=a=>typeof a=="string"?d(a):e.validateFirst?P(a):E(a),u=a=>{typeof a=="string"&&(a=[a]),g(a).forEach(v=>{v.resetValidation()})},h=()=>c.reduce((a,f)=>(a[f.name]=f.getValidationStatus(),a),{}),k=(a,f)=>{c.some(v=>v.name===a?(v.$el.scrollIntoView(f),!0):!1)},T=()=>c.reduce((a,f)=>(f.name!==void 0&&(a[f.name]=f.formValue.value),a),{}),A=()=>{const a=T();b().then(()=>n("submit",a)).catch(f=>{n("failed",{values:a,errors:f});const{scrollToError:v,scrollToErrorPosition:S}=e;v&&f[0].name&&k(f[0].name,S?{block:S}:void 0)})},_=a=>{Y(a),A()};return l({props:e}),be({submit:A,validate:b,getValues:T,scrollToField:k,resetValidation:u,getValidationStatus:h}),()=>{var a;return s("form",{class:ht(),onSubmit:_},[(a=i.default)==null?void 0:a.call(i)])}}});const St=Q(wt);function Se(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function _t(e,n){if(Se(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Vt(e,n){return new Promise(i=>{const c=n.validator(e,n);if(We(c)){c.then(i);return}i(c)})}function de(e,n){const{message:i}=n;return je(i)?i(e,n):i||""}function xt({target:e}){e.composing=!0}function fe({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function kt(e,n){const i=Oe();e.style.height="auto";let c=e.scrollHeight;if(Ne(n)){const{maxHeight:l,minHeight:g}=n;l!==void 0&&(c=Math.min(c,l)),g!==void 0&&(c=Math.max(c,g))}c&&(e.style.height=`${c}px`,qe(i))}function Ct(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function I(e){return[...e].length}function ne(e,n){return[...e].slice(0,n).join("")}const[Et,V]=X("field"),It={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:$,max:Number,min:Number,formatter:Function,clearIcon:N("clear"),modelValue:Ke(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:N("focus"),formatTrigger:N("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},Bt=me({},we,It,{rows:$,type:N("text"),rules:Array,autosize:[Boolean,Object],labelWidth:$,labelClass:K,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Pt=p({name:Et,props:Bt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:i}){const c=dt(),l=nt({status:"unvalidated",focused:!1,validateMessage:""}),g=j(),P=j(),E=j(),{parent:d}=Ze(ve),b=()=>{var t;return String((t=e.modelValue)!=null?t:"")},u=t=>{if(B(e[t]))return e[t];if(d&&B(d.props[t]))return d.props[t]},h=R(()=>{const t=u("readonly");if(e.clearable&&!t){const r=b()!=="",o=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return r&&o}return!1}),k=R(()=>E.value&&i.input?E.value():e.modelValue),T=R(()=>{var t;const r=u("required");return r==="auto"?(t=e.rules)==null?void 0:t.some(o=>o.required):r}),A=t=>t.reduce((r,o)=>r.then(()=>{if(l.status==="failed")return;let{value:m}=k;if(o.formatter&&(m=o.formatter(m,o)),!_t(m,o)){l.status="failed",l.validateMessage=de(m,o);return}if(o.validator)return Se(m)&&o.validateEmpty===!1?void 0:Vt(m,o).then(y=>{y&&typeof y=="string"?(l.status="failed",l.validateMessage=y):y===!1&&(l.status="failed",l.validateMessage=de(m,o))})}),Promise.resolve()),_=()=>{l.status="unvalidated",l.validateMessage=""},a=()=>n("endValidate",{status:l.status,message:l.validateMessage}),f=(t=e.rules)=>new Promise(r=>{_(),t?(n("startValidate"),A(t).then(()=>{l.status==="failed"?(r({name:e.name,message:l.validateMessage}),a()):(l.status="passed",r(),a())})):r()}),v=t=>{if(d&&e.rules){const{validateTrigger:r}=d.props,o=ce(r).includes(t),m=e.rules.filter(y=>y.trigger?ce(y.trigger).includes(t):o);m.length&&f(m)}},S=t=>{var r;const{maxlength:o}=e;if(B(o)&&I(t)>+o){const m=b();if(m&&I(m)===+o)return m;const y=(r=g.value)==null?void 0:r.selectionEnd;if(l.focused&&y){const L=[...t],M=L.length-+o;return L.splice(y-M,M),L.join("")}return ne(t,+o)}return t},w=(t,r="onChange")=>{var o,m;const y=t;t=S(t);const L=I(y)-I(t);if(e.type==="number"||e.type==="digit"){const C=e.type==="number";if(t=Ue(t,C,C),r==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const x=He(+t,(o=e.min)!=null?o:-1/0,(m=e.max)!=null?m:1/0);+t!==x&&(t=x.toString())}}let M=0;if(e.formatter&&r===e.formatTrigger){const{formatter:C,maxlength:x}=e;if(t=C(t),B(x)&&I(t)>+x&&(t=ne(t,+x)),g.value&&l.focused){const{selectionEnd:Z}=g.value,oe=ne(y,Z);M=I(C(oe))-I(oe)}}if(g.value&&g.value.value!==t)if(l.focused){let{selectionStart:C,selectionEnd:x}=g.value;if(g.value.value=t,B(C)&&B(x)){const Z=I(t);L?(C-=L,x-=L):M&&(C+=M,x+=M),g.value.setSelectionRange(Math.min(C,Z),Math.min(x,Z))}}else g.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},ee=t=>{t.target.composing||w(t.target.value)},D=()=>{var t;return(t=g.value)==null?void 0:t.blur()},O=()=>{var t;return(t=g.value)==null?void 0:t.focus()},W=()=>{const t=g.value;e.type==="textarea"&&e.autosize&&t&&kt(t,e.autosize)},_e=t=>{l.focused=!0,n("focus",t),G(W),u("readonly")&&D()},Ve=t=>{l.focused=!1,w(b(),"onBlur"),n("blur",t),!u("readonly")&&(v("onBlur"),G(W),Ye())},le=t=>n("clickInput",t),xe=t=>n("clickLeftIcon",t),ke=t=>n("clickRightIcon",t),Ce=t=>{Y(t),n("update:modelValue",""),n("clear",t)},ie=R(()=>{if(typeof e.error=="boolean")return e.error;if(d&&d.props.showError&&l.status==="failed")return!0}),Ee=R(()=>{const t=u("labelWidth"),r=u("labelAlign");if(t&&r!=="top")return{width:se(t)}}),Ie=t=>{t.keyCode===13&&(!(d&&d.props.submitOnEnter)&&e.type!=="textarea"&&Y(t),e.type==="search"&&D()),n("keypress",t)},re=()=>e.id||`${c}-input`,Be=()=>l.status,Pe=()=>{const t=V("control",[u("inputAlign"),{error:ie.value,custom:!!i.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(i.input)return s("div",{class:t,onClick:le},[i.input()]);const r={id:re(),ref:g,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${c}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:Ve,onFocus:_e,onInput:ee,onClick:le,onChange:fe,onKeypress:Ie,onCompositionend:fe,onCompositionstart:xt};return e.type==="textarea"?s("textarea",ae(r,{inputmode:e.inputmode}),null):s("input",ae(Ct(e.type,e.inputmode),r),null)},Te=()=>{const t=i["left-icon"];if(e.leftIcon||t)return s("div",{class:V("left-icon"),onClick:xe},[t?t():s(q,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ae=()=>{const t=i["right-icon"];if(e.rightIcon||t)return s("div",{class:V("right-icon"),onClick:ke},[t?t():s(q,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Le=()=>{if(e.showWordLimit&&e.maxlength){const t=I(b());return s("div",{class:V("word-limit")},[s("span",{class:V("word-num")},[t]),ye("/"),e.maxlength])}},Me=()=>{if(d&&d.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const r=i["error-message"],o=u("errorMessageAlign");return s("div",{class:V("error-message",o)},[r?r({message:t}):t])}},$e=()=>{const t=u("labelWidth"),r=u("labelAlign"),o=u("colon")?":":"";if(i.label)return[i.label(),o];if(e.label)return s("label",{id:`${c}-label`,for:i.input?void 0:re(),"data-allow-mismatch":"attribute",onClick:m=>{Y(m),O()},style:r==="top"&&t?{width:se(t)}:void 0},[e.label+o])},Re=()=>[s("div",{class:V("body")},[Pe(),h.value&&s(q,{ref:P,name:e.clearIcon,class:V("clear")},null),Ae(),i.button&&s("div",{class:V("button")},[i.button()])]),Le(),Me()];return be({blur:D,focus:O,validate:f,formValue:k,resetValidation:_,getValidationStatus:Be}),it(Je,{customValue:E,resetValidation:_,validateWithTrigger:v}),at(()=>e.modelValue,()=>{w(b()),_(),v("onChange"),G(W)}),lt(()=>{w(b(),e.formatTrigger),G(W)}),Ge("touchstart",Ce,{target:R(()=>{var t;return(t=P.value)==null?void 0:t.$el})}),()=>{const t=u("disabled"),r=u("labelAlign"),o=Te(),m=()=>{const y=$e();return r==="top"?[o,y].filter(Boolean):y||[]};return s(bt,{size:e.size,class:V({error:ie.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ee.value,valueClass:V("value"),titleClass:[V("label",[r,{required:T.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:o&&r!=="top"?()=>o:null,title:m,value:Re,extra:i.extra})}}});const Tt=Q(Pt),[At,ge]=X("cell-group"),Lt={title:String,inset:Boolean,border:J};var Mt=p({name:At,inheritAttrs:!1,props:Lt,setup(e,{slots:n,attrs:i}){const c=()=>{var g;return s("div",ae({class:[ge({inset:e.inset}),{[Qe]:e.border&&!e.inset}]},i,Xe()),[(g=n.default)==null?void 0:g.call(n)])},l=()=>s("div",{class:ge("title",{inset:e.inset})},[n.title?n.title():e.title]);return()=>e.title||n.title?s(rt,null,[l(),c()]):c()}});const $t=Q(Mt),Rt={class:"login"},zt={class:"warp"},Ft={class:"title"},Dt={style:{margin:"16px"}},Ot={__name:"login",setup(e){const n=et(),{$t:i}=he().proxy,c=j(!1),l=j({email:"",password:""}),g=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,P=/^((?=.*[A-Za-z])(?=.*\d)|(?=.*[A-Za-z])(?=.*[!@#$%^&*()_+\-\=])|(?=.*\d)(?=.*[!@#$%^&*()_+\-\=]))[A-Za-z\d!@#$%^&*()_+\-\=]{8,}$/,E=u=>{if(!g.test(u))return i("login.emailFail")},d=u=>{if(u===""||!P.test(u))return i("login.passwordFail")},b=u=>{if(u.password==="")return te("password cannot be empty");if(u.email==="")return te("Email cannot be empty");try{n.toLogin(u)}catch(h){h.indexOf("Email already exists")!=-1&&(l.value.password=""),te(h),console.error(h)}};return(u,h)=>{const k=Tt,T=$t,A=tt,_=St;return st(),ot("div",Rt,[z("div",zt,[z("p",Ft,ue(U(i)("login.loginLabel")),1),z("div",null,[s(_,{onSubmit:b},{default:H(()=>[s(T,{inset:""},{default:H(()=>[s(k,{modelValue:l.value.email,"onUpdate:modelValue":h[0]||(h[0]=a=>l.value.email=a),label:U(i)("login.emailLabel"),name:"email",rules:[{validator:E}],"label-align":"top"},null,8,["modelValue","label","rules"]),s(k,{modelValue:l.value.password,"onUpdate:modelValue":h[2]||(h[2]=a=>l.value.password=a),type:c.value?"text":"password",name:"password",label:U(i)("login.passwordLabel"),rules:[{validator:d}],"label-align":"top"},{button:H(()=>[z("div",{onClick:h[1]||(h[1]=a=>c.value=!c.value)},[z("i",{class:ct(["iconfont",c.value?"icon-kejian":"icon-yanjing-guan"])},null,2)])]),_:1},8,["modelValue","type","label","rules"])]),_:1}),z("div",Dt,[s(A,{round:"",block:"",type:"primary","native-type":"submit"},{default:H(()=>[ye(ue(U(i)("login.submitBut")),1)]),_:1})])]),_:1})])])])}}},jt=pe(Ot,[["__scopeId","data-v-98b6518a"]]);export{jt as default};
